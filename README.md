See http://jthomerson.github.io/mongodb-safe-upserts-array-subdocuments/ to see this slide presentation.

Note that this is still a work in progress. I'll also include full code examples soon.
